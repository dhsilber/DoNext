{"ast":null,"code":"import { DayMilliseconds, HourMilliseconds } from '../Constants';\nimport { dayTimestampStartMilliseconds } from '../DayStartMillisocnds';\n\nconst eventSorter = source => {\n  const startTime = Date.now() - 2 * HourMilliseconds;\n  const endTime = Date.now() + 48 * HourMilliseconds;\n  const routineSchedule = source.routine;\n  const startMidnight = dayTimestampStartMilliseconds(startTime);\n  const midnights = [];\n\n  for (let midnight = startMidnight; midnight < endTime; midnight += DayMilliseconds) {\n    midnights.push(midnight);\n  }\n\n  console.log(`Midnight: ${midnights}`);\n  const constructedEvents = midnights.flatMap(midnight => {\n    let routineEvents = [];\n    routineSchedule.map(routine => {\n      let event = {\n        text: routine.text,\n        start: midnight + routine.start,\n        duration: routine.duration\n      };\n      routineEvents.push(event);\n    });\n    return routineEvents;\n  });\n  constructedEvents.push({\n    text: \"<-------------------- Now --------------------<\",\n    duration: 0,\n    start: Date.now()\n  });\n  console.log(\"constructedEvents: \", constructedEvents);\n  const currentEvents = constructedEvents.concat(source.events).sort((a, b) => {\n    if (b.start > a.start) {\n      return -1;\n    } else {\n      return 1;\n    }\n  }).filter(event => event.start + event.duration > startTime && event.start < endTime);\n  return currentEvents;\n};\n\nexport default eventSorter;","map":{"version":3,"names":["DayMilliseconds","HourMilliseconds","dayTimestampStartMilliseconds","eventSorter","source","startTime","Date","now","endTime","routineSchedule","routine","startMidnight","midnights","midnight","push","console","log","constructedEvents","flatMap","routineEvents","map","event","text","start","duration","currentEvents","concat","events","sort","a","b","filter"],"sources":["/Users/dhs/do-next/src/event/EventSorter.ts"],"sourcesContent":["import { DayMilliseconds, HourMilliseconds } from '../Constants'\nimport { dayTimestampStartMilliseconds } from '../DayStartMillisocnds'\nimport { DoEventsData, EventData } from '../DoData'\n\nconst eventSorter = (source: DoEventsData) => {\n\n    const startTime = Date.now() - 2 * HourMilliseconds\n    const endTime = Date.now() + 48 * HourMilliseconds\n\n    const routineSchedule = source.routine\n\n    const startMidnight = dayTimestampStartMilliseconds(startTime)\n    const midnights: number[] = []\n    for (let midnight = startMidnight; midnight < endTime; midnight += DayMilliseconds) {\n        midnights.push(midnight)\n    }\n    console.log(`Midnight: ${midnights}`)\n\n    const constructedEvents = midnights.flatMap((midnight) => {\n        let routineEvents: EventData[] = []\n        routineSchedule.map((routine) => {\n            let event: EventData = {\n                text: routine.text,\n                start: midnight + routine.start,\n                duration: routine.duration\n            }\n            routineEvents.push(event)\n        })\n        return routineEvents\n    })\n    constructedEvents.push({text: \"<-------------------- Now --------------------<\",duration:0,start: Date.now()})\n\n    console.log(\"constructedEvents: \", constructedEvents)\n\n    const currentEvents = constructedEvents.concat(source.events)\n        .sort((a, b) => { if (b.start > a.start) { return -1 } else { return 1 } })\n        .filter(event => (event.start + event.duration) > startTime && event.start < endTime)\n\n    return currentEvents\n}\n\nexport default eventSorter"],"mappings":"AAAA,SAASA,eAAT,EAA0BC,gBAA1B,QAAkD,cAAlD;AACA,SAASC,6BAAT,QAA8C,wBAA9C;;AAGA,MAAMC,WAAW,GAAIC,MAAD,IAA0B;EAE1C,MAAMC,SAAS,GAAGC,IAAI,CAACC,GAAL,KAAa,IAAIN,gBAAnC;EACA,MAAMO,OAAO,GAAGF,IAAI,CAACC,GAAL,KAAa,KAAKN,gBAAlC;EAEA,MAAMQ,eAAe,GAAGL,MAAM,CAACM,OAA/B;EAEA,MAAMC,aAAa,GAAGT,6BAA6B,CAACG,SAAD,CAAnD;EACA,MAAMO,SAAmB,GAAG,EAA5B;;EACA,KAAK,IAAIC,QAAQ,GAAGF,aAApB,EAAmCE,QAAQ,GAAGL,OAA9C,EAAuDK,QAAQ,IAAIb,eAAnE,EAAoF;IAChFY,SAAS,CAACE,IAAV,CAAeD,QAAf;EACH;;EACDE,OAAO,CAACC,GAAR,CAAa,aAAYJ,SAAU,EAAnC;EAEA,MAAMK,iBAAiB,GAAGL,SAAS,CAACM,OAAV,CAAmBL,QAAD,IAAc;IACtD,IAAIM,aAA0B,GAAG,EAAjC;IACAV,eAAe,CAACW,GAAhB,CAAqBV,OAAD,IAAa;MAC7B,IAAIW,KAAgB,GAAG;QACnBC,IAAI,EAAEZ,OAAO,CAACY,IADK;QAEnBC,KAAK,EAAEV,QAAQ,GAAGH,OAAO,CAACa,KAFP;QAGnBC,QAAQ,EAAEd,OAAO,CAACc;MAHC,CAAvB;MAKAL,aAAa,CAACL,IAAd,CAAmBO,KAAnB;IACH,CAPD;IAQA,OAAOF,aAAP;EACH,CAXyB,CAA1B;EAYAF,iBAAiB,CAACH,IAAlB,CAAuB;IAACQ,IAAI,EAAE,iDAAP;IAAyDE,QAAQ,EAAC,CAAlE;IAAoED,KAAK,EAAEjB,IAAI,CAACC,GAAL;EAA3E,CAAvB;EAEAQ,OAAO,CAACC,GAAR,CAAY,qBAAZ,EAAmCC,iBAAnC;EAEA,MAAMQ,aAAa,GAAGR,iBAAiB,CAACS,MAAlB,CAAyBtB,MAAM,CAACuB,MAAhC,EACjBC,IADiB,CACZ,CAACC,CAAD,EAAIC,CAAJ,KAAU;IAAE,IAAIA,CAAC,CAACP,KAAF,GAAUM,CAAC,CAACN,KAAhB,EAAuB;MAAE,OAAO,CAAC,CAAR;IAAW,CAApC,MAA0C;MAAE,OAAO,CAAP;IAAU;EAAE,CADxD,EAEjBQ,MAFiB,CAEVV,KAAK,IAAKA,KAAK,CAACE,KAAN,GAAcF,KAAK,CAACG,QAArB,GAAiCnB,SAAjC,IAA8CgB,KAAK,CAACE,KAAN,GAAcf,OAF3D,CAAtB;EAIA,OAAOiB,aAAP;AACH,CAnCD;;AAqCA,eAAetB,WAAf"},"metadata":{},"sourceType":"module"}